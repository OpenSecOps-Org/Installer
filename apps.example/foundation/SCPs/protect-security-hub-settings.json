{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "ProtectMutationBaseline",
      "Effect": "Deny",
      "Action": [
        "securityhub:AcceptAdministratorInvitation",
        "securityhub:AcceptInvitation",
        "securityhub:BatchDisableStandards",
        "securityhub:BatchEnableStandards",
        "securityhub:BatchUpdateStandardsControlAssociations",
        "securityhub:DeclineInvitations",
        "securityhub:Disable*",
        "securityhub:Disassociate*",
        "securityhub:Enable*",
        "securityhub:InviteMembers",
        "securityhub:TagResource",
        "securityhub:UntagResource",
        "securityhub:Update*"
      ],
      "Resource": "*",
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalArn": [
            "arn:aws:iam::*:role/AWSControlTowerExecution",
            "arn:aws:iam::*:role/SecurityHubRole",
            "arn:aws:iam::*:role/aws-reserved/sso.amazonaws.com/*/AWSReservedSSO_AWSAdministratorAccess_*",
            "arn:aws:iam::*:role/stacksets-exec-*"
          ]
        }
      }
    },
    {
      "Sid": "ProtectMutationOutsideSecurityAccount",
      "Effect": "Deny",
      "Action": [
        "securityhub:BatchUpdateFindings",
        "securityhub:Create*",
        "securityhub:Delete*"
      ],
      "Resource": "*",
      "Condition": {
        "StringNotEquals": {
          "aws:PrincipalAccount": "772712624189"
        },
        "ArnNotLike": {
          "aws:PrincipalArn": [
            "arn:aws:iam::*:role/AWSControlTowerExecution",
            "arn:aws:iam::*:role/SecurityHubRole",
            "arn:aws:iam::*:role/aws-reserved/sso.amazonaws.com/*/AWSReservedSSO_AWSAdministratorAccess_*",
            "arn:aws:iam::*:role/stacksets-exec-*"
          ]
        }
      }
    },
    {
      "Sid": "ProtectMutationInSecurityAccountExceptForCustomActions",
      "Effect": "Deny",
      "Action": [
        "securityhub:CreateFindingAggregator",
        "securityhub:CreateInsight",
        "securityhub:CreateMembers",
        "securityhub:DeleteFindingAggregator",
        "securityhub:DeleteInsight",
        "securityhub:DeleteMembers"
      ],
      "Resource": "*",
      "Condition": {
        "StringEquals": {
          "aws:PrincipalAccount": "772712624189"
        },
        "ArnNotLike": {
          "aws:PrincipalArn": [
            "arn:aws:iam::*:role/AWSControlTowerExecution",
            "arn:aws:iam::*:role/SecurityHubRole",
            "arn:aws:iam::*:role/aws-reserved/sso.amazonaws.com/*/AWSReservedSSO_AWSAdministratorAccess_*",
            "arn:aws:iam::*:role/stacksets-exec-*",
            "arn:aws:iam::772712624189:role/sec-hub-custom-actions-*"
          ]
        }
      }
    }
  ]
}
